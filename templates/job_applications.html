<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Applications for {{ job.job_title }} | CareerConnect</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />
  </head>
  <body style="background: #f5f7fb;">
    <div class="container py-4">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <div>
          <h4 class="mb-1">Applications</h4>
          <div class="text-muted small">{{ job.job_title }} • {{ job.job_location }} • {{ job.employment_type }}</div>
        </div>
        <a href="{{ url_for('recruiter_dashboard') }}" class="btn btn-outline-secondary">Back</a>
      </div>

      <div class="card shadow-sm">
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-hover align-middle">
              <thead class="table-light">
                <tr>
                  <th>Candidate</th>
                  <th>Email</th>
                  <th>Status</th>
                  <th>Applied</th>
                  <th>ATS Score</th>
                  <th class="text-end">Actions</th>
                </tr>
              </thead>
              <tbody>
                {% if applications and applications|length > 0 %}
                  {% for app in applications %}
                  <tr>
                    <td class="fw-semibold">{{ app.candidate_name }}</td>
                    <td>{{ app.candidate_email }}</td>
                    <td>
                      {% if app.status == 'applied' %}
                        <span class="badge bg-secondary">Applied</span>
                      {% elif app.status == 'shortlisted' %}
                        <span class="badge bg-info">Shortlisted</span>
                      {% elif app.status == 'rejected' %}
                        <span class="badge bg-danger">Rejected</span>
                      {% elif app.status == 'hired' %}
                        <span class="badge bg-success">Hired</span>
                      {% else %}
                        <span class="badge bg-secondary">{{ app.status }}</span>
                      {% endif %}
                    </td>
                    <td>{{ app.applied_at[:10] if app.applied_at else '-' }}</td>
                    <td>
                      {% if application_ats_scores and app.id in application_ats_scores %}
                        <span class="badge bg-success">{{ application_ats_scores[app.id] }}</span>
                      {% else %}
                        <span class="badge bg-secondary">--</span>
                      {% endif %}
                    </td>
                    <td class="text-end">
                      <a class="btn btn-sm btn-outline-primary" href="{{ url_for('view_candidate', seeker_user_id=app.seeker_user_id) }}?application_id={{ app.id }}">View Resume</a>
                    </td>
                  </tr>
                  {% endfor %}
                {% else %}
                  <tr>
                    <td colspan="6" class="text-muted text-center py-4">No applications yet</td>
                  </tr>
                {% endif %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
  </body>
</html>
